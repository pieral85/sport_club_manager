<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <!-- tree view(s) -->
        <record id="period_view_list" model="ir.ui.view">
            <field name="name">period list</field>
            <field name="model">period</field>
            <!-- <field name="domain">[('active', '=', False),]</field> -->
            <field name="arch" type="xml">
                <tree>
                    <field name="name"/>
                    <field name="current"/>
                    <field name="upcoming"/>
                    <field name="start_date"/>
                    <field name="end_date"/>
                </tree>
            </field>
        </record>

        <!-- form view(s) -->
        <record id="period_view_form" model="ir.ui.view">
            <field name="name">period form</field>
            <field name="model">period</field>
            <!-- <field name="domain">[('type','in', ['out_invoice', 'out_refund']), ('state', 'not in', ['draft', 'cancel'])]</field> -->
            <field name="arch" type="xml">
                <form>
                    <header>
                        <field name="current" invisible="1"/>
                        <button name="copy" type="object" string="Create New Period Based on Current" class="btn-primary" attrs="{'invisible': [('current', '=', False)]}" confirm="You are going to duplicate this period. Related categories and members will also be duplicated. Do you want to continue?"/>
                    </header>
                    <sheet>
                        <div class="oe_button_box" name="button_box">
                            <button name="toggle_active" type="object" class="oe_stat_button" icon="fa-archive">
                                <field name="active" widget="boolean_button" options="{'terminology': 'archive'}"/>
                            </button>
                        </div>
                        <group>
                            <h1>
                                <field name="name" placeholder="Name..."/>
                            </h1>                            
                            <field name="start_date"/>
                            <field name="end_date"/>
                            <field name="current" readonly="1"/>
                            <field name="upcoming" readonly="1"/>
                        </group>
                        <notebook>
                            <page string="Categories">
                                <field name="period_category_ids">
                                    <tree editable="bottom">
                                        <field name="category_id"/>
                                        <field name="price_due" widget="monetary"/>
                                        <field name="count_members"/>
                                        <field name="default"/>
                                        <field name="remaining_price_due"/>
                                    </tree>
                                </field>
                            </page>
                            <page string="Members">
                                <field name="user_ids">
                                    <tree editable="bottom">
                                        <field name="name"/>
                                        <!-- TODO <field name="...category (should be unique!!!)"/>
                                        <field name="...payment (statusbar)"/> -->
                                    </tree>
                                </field>
                            </page>
                            <page string="Emails">
                                <group>
                                    <label for="alias_name" string="Email Alias"/>
                                    <div name="alias_def">
                                        <field name="alias_id" class="oe_read_only oe_inline" string="Email Alias" required="0"/>
                                        <div class="oe_edit_only oe_inline" name="edit_alias" style="display: inline;" >
                                            <field name="alias_name" class="oe_inline"/>
                                            @
                                            <field name="alias_domain" class="oe_inline" readonly="1"/>
                                        </div>
                                    </div>
                                    <field name="alias_contact" class="oe_inline" string="Accept Emails From"/>
                                </group>
                            </page>
                        </notebook>
                    </sheet>
                </form>
            </field>
        </record>

        <!-- kanban view(s) -->
        <!-- TO BE IMPLEMENTED -->

        <!-- search view(s) -->
        <record id="period_search" model="ir.ui.view">
            <field name="name">period.inactive.search</field>
            <field name="model">period</field>
            <field name="arch" type="xml">
                <search string="Periods">
                    <field name="name" filter_domain="[('start_date', '&lt;=',self), ('end_date', '&gt;=', self)]" string="Period Including Date"/>
                    <!-- <field name="name" filter_domain="['|', '|', ('name','ilike',self), ('login','ilike',self), ('email','ilike',self)]" string="User"/> -->
                    <separator/>
                    <filter string="Active" name ="active_search" icon="terp-gtk-media-pause" domain="[('active','=', True)]" help="Only active period."/>
                    <filter string="Archived" name ="inactive_search" icon="terp-gtk-media-pause" domain="[('active','=', False)]" help="Only inactive periods."/>
                    <!-- <separator/>
                    <filter string="test_annee" name="annee_search" domain="['|', ('name', 'ilike', 'annee'), ('name', 'ilike', 'year')]]"/> -->
                    <!-- <filter string="name" domain="[]" context="{"group_by" : "field"}" /> --><!-- TODO Need to have a group by? What about other modules? -->
                </search>
            </field>
        </record>

        <!-- action(s) -->
        <record id="action_settings_period" model="ir.actions.act_window">
            <field name="name">Periods</field>
            <field name="context">{'search_default_active_search': 1, 'search_default_inactive_search': 1}</field>
            <field name="res_model">period</field>
            <!-- <field name="view_type">form</field> -->
            <field name="view_mode">tree,form</field>
        </record>
    </data>
</odoo>